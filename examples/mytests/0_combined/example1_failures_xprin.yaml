tests:
- name: "Render failure (claim used as XR)"
  inputs:
    xr: ../../aws/claim.yaml
    composition: ../../aws/composition.yaml
    functions: ../../aws/functions.yaml

- name: "Validation failure (v1 only) (missing required team)"
  inputs:
    xr: ../../aws/xr_without_team.yaml
    composition: ../../aws/composition.yaml
    functions: ../../aws/functions.yaml
    crds:
    - ../../aws/xrd-aws.yaml
    - ../../aws/crossplane.yaml

- name: "Pre-test hook failure"
  inputs:
    xr: ../../aws/xr.yaml
    composition: ../../aws/composition.yaml
    functions: ../../aws/functions.yaml
  hooks:
    pre-test:
    - name: "Fail pre-test hook"
      run: exit 1

- name: "Pre-test hook failure (unnamed)"
  inputs:
    xr: ../../aws/xr.yaml
    composition: ../../aws/composition.yaml
    functions: ../../aws/functions.yaml
  hooks:
    pre-test:
    - run: exit 1

- name: "Pre-test hook failure (multiline stderr)"
  inputs:
    xr: ../../aws/xr.yaml
    composition: ../../aws/composition.yaml
    functions: ../../aws/functions.yaml
  hooks:
    pre-test:
    - name: "Fail pre-test hook (multiline stderr)"
      run: |
        echo "first line" >&2
        echo "second line" >&2
        echo "third line" >&2
        exit 1

- name: "Pre-test hook failure (multiline stdout)"
  inputs:
    xr: ../../aws/xr.yaml
    composition: ../../aws/composition.yaml
    functions: ../../aws/functions.yaml
  hooks:
    pre-test:
    - name: "Fail pre-test hook (multiline stdout)"
      run: |
        echo "stdout line 1"
        echo "stdout line 2"
        exit 1

- name: "Pre-test hook failure (multiline stdout and stderr)"
  inputs:
    xr: ../../aws/xr.yaml
    composition: ../../aws/composition.yaml
    functions: ../../aws/functions.yaml
  hooks:
    pre-test:
    - name: "Fail pre-test hook (multiline stdout and stderr)"
      run: |
        echo "stdout A"
        echo "stdout B"
        echo "stderr 1" >&2
        echo "stderr 2" >&2
        exit 1

- name: "Successful test case"
  inputs:
    xr: ../../aws/xr.yaml
    composition: ../../aws/composition.yaml
    functions: ../../aws/functions.yaml

- name: "Post-test hook failure"
  inputs:
    xr: ../../aws/xr.yaml
    composition: ../../aws/composition.yaml
    functions: ../../aws/functions.yaml
  hooks:
    post-test:
    - name: "Fail post-test hook"
      run: exit 1

- name: "Assertion failure"
  inputs:
    xr: ../../aws/xr.yaml
    composition: ../../aws/composition.yaml
    functions: ../../aws/functions.yaml
  assertions:
    xprin:
    - name: "Resource count should be zero"
      type: "Count"
      value: 0

- name: "Render failure (missing required inputs - multiline error)"
